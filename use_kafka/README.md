# Kafka를 이용한 메시지 생성 및 소비

이 프로젝트는 Spring Boot와 Apache Kafka를 이용해 메시지를 생성(Publish)하고 소비(Consume)하는 과정을 이해하기 위해 시도했습니다.
추가적으로 메세지 미들웨어를 이용함으로써 발생할 수 있는 메시지 순서 보장, 트랜잭션 롤백(Saga Pattern), 지연 소비(Deferred Processing) 등도 정리할 예정입니다.

---

## 🔍 주요 질문과 고민

1. Kafka에서 메시지는 어떻게 생성하고 소비할까?  
   → Spring에서 Kafka와 통신하는 방법은 무엇인지?

2. 서비스가 여러 개인 경우, 메시지 순서는 어떻게 보장할 수 있을까?  
   → Kafka의 파티션 구조와 키 전략이 순서 보장에 어떤 영향을 줄까?

3. 서비스 중 하나에서 오류가 발생했을 때, Saga 패턴으로 트랜잭션을 어떻게 롤백할 수 있을까?

4. 모든 메시지를 즉시 처리해야 할까?  
   만약 나중에 처리하고 싶다면 어떻게 할까? (지연 소비 전략 등)

---

## ✅ 구현 방향 및 해법

### 1. 메시지 생성 및 소비
- Spring Kafka의 KafkaTemplate을 사용하여 메시지를 발행합니다.
- @KafkaListener를 이용하여 메시지를 비동기적으로 수신합니다.

### 2. 메시지 순서 보장
- Kafka는 파티션 단위로 순서를 보장합니다.
- 같은 Partition Key를 사용하는 메시지는 FIFO로 처리됩니다.
- 순서를 보장해야 할 경우, 같은 key로 전송하고 동일 파티션에서 처리되도록 합니다.

### 3. SAGA 패턴을 통한 트랜잭션 보상 처리

### 4. 메시지 지연 소비

---

## 🚀 실행 방법

### branch - main 1번인 메세지를 생성하고 소비하는 예제

1. Docker로 Kafka & Zookeeper 실행  
2. Spring Boot 애플리케이션 실행  
3. `/` 엔드포인트 호출 → Kafka로 메시지 전송  
4. Console 또는 로그에서 Consumer가 메시지를 수신하는지 확인

---



